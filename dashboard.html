<script>

const token = "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";
const repo = "veera1016/sky";
const file = "data.json";

async function updateAWB(){

const shipment = {
  awb: document.getElementById("awb").value,
  date: document.getElementById("date").value,
  consignee: document.getElementById("consignee").value,
  destination: document.getElementById("destination").value,
  status: document.getElementById("status").value,
  deliveryDate: document.getElementById("deliveryDate").value,
  receiver: document.getElementById("receiver").value,
  deliveryAwb: document.getElementById("deliveryAwb").value,
  progress: []
};

// Get current JSON
let res = await fetch(`https://api.github.com/repos/${repo}/contents/${file}`);
let data = await res.json();
let content = JSON.parse(atob(data.content));

// Add shipment
content.shipments.push(shipment);

// Update GitHub file
await fetch(`https://api.github.com/repos/${repo}/contents/${file}`, {
  method:"PUT",
  headers:{
    "Authorization":"token "+token,
    "Content-Type":"application/json"
  },
  body:JSON.stringify({
    message:"Add shipment",
    content:btoa(JSON.stringify(content, null, 2)),
    sha:data.sha
  })
});

alert("Saved permanently in GitHub!");

}

</script>
