<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <title>Client Dashboard | SKY EXPRESS</title>
  <link rel="stylesheet" href="style.css">
  <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.5.0/css/all.min.css" />
</head>
<body style="padding: 50px 20px;">
  <div class="centered-container" style="max-width: 800px;">
    <div class="pickup-form-container">
      <h2>Manage Tracking IDs</h2>
      <p>Add new tracking information below.</p>
      
      <div class="form-group" style="margin-top:20px;">
        <label>Tracking ID</label>
        <input type="text" id="newId" placeholder="e.g. SKY999">
      </div>
      <div class="form-group">
        <label>Full Status Message</label>
        <textarea id="newStatus" rows="3" placeholder="Status: In Transit <br> Location: Vizag"></textarea>
      </div>
      <button onclick="addTracking()" class="btn-main">Save & Update Shipment</button>
      <hr style="margin: 30px 0; border: 0; border-top: 1px solid #eee;">
      
      <h3>Current Active Shipments</h3>
      <div id="admin-list" style="margin-top:20px;"></div>
    </div>
  </div>

  <script>
    // Security Check
    if(sessionStorage.getItem('isAdmin') !== 'true') { window.location.href = 'login.html'; }

    function addTracking() {
      const id = document.getElementById('newId').value.toUpperCase();
      const status = document.getElementById('newStatus').value;
      if(!id || !status) return alert("Fill all fields");

      let data = JSON.parse(localStorage.getItem('skyExpressData')) || {};
      data[id] = status;
      localStorage.setItem('skyExpressData', JSON.stringify(data));
      alert("Updated!");
      location.reload();
    }

    function renderList() {
      const data = JSON.parse(localStorage.getItem('skyExpressData')) || {};
      const list = document.getElementById('admin-list');
      for (let id in data) {
        list.innerHTML += `
          <div style="background:#fff; padding:15px; margin-bottom:10px; border-radius:8px; display:flex; justify-content:space-between; align-items:center; border: 1px solid #eee;">
            <div><strong>${id}</strong>: ${data[id]}</div>
            <button onclick="deleteId('${id}')" style="background:red; color:white; border:none; padding:5px 10px; border-radius:5px; cursor:pointer;">Delete</button>
          </div>`;
      }
    }

    function deleteId(id) {
      let data = JSON.parse(localStorage.getItem('skyExpressData')) || {};
      delete data[id];
      localStorage.setItem('skyExpressData', JSON.stringify(data));
      location.reload();
    }
    renderList();
  </script>
</body>
</html>